
网络核心中没有应用层软件。网络应用只在端系统上存在。

## 应用层协议原理
### 网络应用的体系结构
- 客户-服务器模式（C/S: client/server）
- 对等模式(P2P: Peer To Peer)
- 混合体：客户-服务器和对等体系结构

### 客户端-服务器 (C/S) 架构

![|600](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250119224245.png)

### P2P
![I600](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250119233304.png)

### C/S和P2P体系结构的混合体
![|600](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250119234249.png)

### 进程通信
进程：在主机上运行的应用程序

客户端进程：发起通信的进程
服务器进程：等待连接的进程

- 在同一个主机内，使用进程间通信机制通信。
- 不同主机，通过交换报文来通信
	- 使用 OS 提供的通信服务
	- 按照应用协议交换报文
		- 借助传输层提供的服务

P2P架构的应用也有客户端进程和服务器进程之分

### 进程标识和寻址问题 (服务用户)
进程为了接收报文，必须要有一个标识，即 SAP (发送也需要)：
- 主机：唯一的 32 位 IP 地址
- 采用的传输层协议是 TCP 还是 UDP
- **端口号**

一个进程：用IP + port 标示端节点。
一对主机进程之间的通信由2个端节点构成。

### 传输层向应用层提供的服务-需要穿过层间的信息 (服务)
![|500](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250120000339.png)

层间接口(上下层要交流的信息)必须要携带的信息 (谁发的，发给谁，发什么)
- 要传输的报文，对于本层来说是 SDU(服务数据单元)
- 谁传的：己方应用进程标识：IP+TCP(UDP) 端口
- 传给谁：对方的应用进程的标示：对方的 IP+TCP(UDP) 端口号

传输层实体 (TCP 或者 UDP 实体) 根据这些信息进行 TCP 报文段 (UDP 数据报) 的封装
- 源端口号，目标端口号，数据等
- 将 IP 地址往下交 IP 实体，用于封装 IP 数据报：源 IP,目标 IP

#### TCP Socket
实际上是用一个整数表示两个应用实体之间的通信关系(四元组，包含源 IP、源端口、目标 IP、目标端口)，他是四元组的本地标示，代表着一个**会话关系**。让穿过层间接口的信息量最小。

![|525](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250120002614.png)

#### UDP Socket
UDP 服务的话，两个进程之间通信之前无需建立连接。只能用一个整数表示本应用实体的表示 (因为这个报文可能传给另外一个分布式进程)。
UDP Socket 也就是是 2 元组 (源 IP，源 Port) 的一个本地意义标识。

但是传输报文时：必须要提供对方 IP，port
接收报文时：传输层需要上传对方 IP，port

![|525](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250120003430.png)

#### 套接字 Socket
进程向套接字发送报文或从套接字接收报文

![|525](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250120004119.png)

### 如何使用传输层提供的服务实现应用 (用户使用服务)
定义应用层协议：报文格式，解释，时序等
#### 应用层协议
定义了运行在不同端系统上的应用进程如何相互交换报文
- 交换的报文类型：请求和应答报文
- 各种报文类型的语法：报文中的各个字段及其描述
- 字段的语义：即字段取值的含义
- 进程何时、如何发送报文及对报文进行响应的规则

### 传输层向上层提供服务的性能指标
- 数据丢失率
- 延迟
- 吞吐
- 安全性：机密性、完整性、可认证性

### Internet 传输层提供的服务
#### TCP 服务
- 可靠的传输服务
- 流量控制：发送方不会淹没接受方
- 拥塞控制：当网络出现拥塞时，能抑制发送方
- $\color{red}{不能}$ 提供的服务：时间保证、最小吞吐保证和安全
- 面向连接：要求在客户端进程和服务器进程之间建立连接

#### UDP 服务
- 不可靠数据传输
- $\color{red}{不能}$ 提供的服务：可靠、流量控制、拥塞控制、时间、带宽保证、建立连接
- 能够区分不同的进程，而IP服务不能 (在IP提供的主机到主机端到端功能的基础上，区分了主机的应用进程)
- 无需建立连接，省去了建立连接时间，适合事务性的应用
- 不做可靠性的工作，例如检错重发，适合那些对实时性要求比较高而对正确性要求不高的应用 
- 没有拥塞控制和流量控制，应用能够按照设定的速度发送数据。而在TCP上面的应用，应用发送数据的速度和主机向网络发送的实际速度是不一致的，因为有流量控制和拥塞控制

#### 安全 TCP
![|500](https://typora-birdy.oss-cn-guangzhou.aliyuncs.com/20250120010425.png)

## Web 和 HTTP
